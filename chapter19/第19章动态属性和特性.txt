第六部分 元编程
第19章 动态属性和特性
特性至关重要的地方在于,特性(property)的存在使得开发者可以非常安全并且确定可行地将公共数据属性作为类的公共接口的一部分开放出来.
在Python中,数据的属性和处理数据的方法统称为属性(attribute).
其实,方法只是可调用的属性.
除了这二者之外,我们还可以创建特性(property),在不改变类接口的前提下,使用存取方法(即读值方法和设值方法)修改数据属性
这与统一访问原则相符:
不管服务是由存储还是计算实现的,一个模块提供的所有服务都应该通过统一的方式使用.
除了特性,Python还提供了丰富的API,用于控制属性的访问权限,以及实现动态属性.
使用点号访问属性时(如obj.attr),Python解释器会调用特殊的方法(如__getattr__和__setattr__)计算属性.
用户自己定义的类可以通过__getattr__方法实现"虚拟属性",当访问不存在的属性时(如obj.no_such_attribute),即时计算属性的值
动态创建属性是一种元编程,框架的作者经常这么做.
19.1 使用动态属性转换数据
使用动态属性处理JSON格式数据源.
示例19-1 asconfeed.json文件中的记录示例:
示例19-2 osconfeed.py:下载osconfeed.json
19.1.1 使用动态属性访问JSON类数据
实现FrozenJSON类,只支持读取,即只能访问数据.
这个类能递归,自动处理嵌套的映射和列表
